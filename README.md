
JUDCon Boston 2013 JBoss Enterprise Data Grid & Websocket Push Demo Code
------------------------------------------------------------------------
This project contains the code demo'ed at JUDCon in Boston, June 2013
What follows are the steps required to re-create the environment used.

Preparation
===========
To begin you'll need to download the following:

JDK 7
-----
You need a copy of the Java 7 SDK, ensure this is your default java installation

Wildfly
-------
We are using JBoss wildfly for Java EE 7 Websocket support, you can get a copy here:
http://www.wildfly.org/download/

HornetQ
-------
This example uses a standalone HornetQ server to de-duplicate events generated by the data-grid.
You can get a copy from here:
https://www.jboss.org/hornetq/downloads

JBoss Enterprise Data Grid
--------------------------
Using your Redhat subscription download Maven artifacts named "JBoss Data Grid 6.1.0 Maven Repository" and extract these to a location of your choice.
From now on we'll refer to this location as ${local-jdg-maven-repo}.  We will need to configure the application pom.xml with this value to do a build.

Get a copy of this source code
------------------------------
git clone https://github.com/mark-addy/jdg-websocket-ee7.git
From now on we'll refer to your local root installation directory of the source code as ${source}

Installation
============
Once you have your downloads follows these steps to configure the environment, run the infrastructure, build the application and deploy it.


Application Build
-----------------
In the location you cloned the source code from github (${source}) you will need to update the pom.xml with the location of your local JBoss Data Grid Maven repository.
Edit pom.xml and update the following path with the value ${local-jdg-maven-repo} from your environment.

	<repositories>
		...
		<repository>
			<id>local</id>
			<url>file:///opt/jboss-data-grid/downloads/jboss-datagrid-maven-repository-6.1.0</url>
		</repository>
	</repositories>

Build the application using the following command from the ${source} directory:

mvn clean package

Ok, thats the application built.

HornetQ setup
-------------
Extract your hornetq download and copy and replace the non-clustered stand-alone configuration files with those contained within this project:

cp ${source}/src/main/resources/hornetq/config/stand-alone/non-clustered/* ${hornetq-home}/config/stand-alone/non-clustered

The changes made to the default HornetQ distribution are as follows:
1) Turn off message persistence
2) Change the default netty acceptor port to 6445

You can now start Hornetq

${hornetq-home}/bin/run.sh

Wildfly setup
-------------
Copy the wildfly distribution to a location of your choice, we'll call this ${wildfly-home}
Copy the following files from this project into the same location:

cp ${source}/src/main/resources/wildfly/* ${wildfly-home}

Run the install, this process:
1) Extracts the distribution
2) Creates a management user (using your default login name)
3) Moves a cli script to the bin directory 
4) Starts wildfly in domain mode

${wildfly-home}/install-wildfly.sh

Open a new window and navigate to the wildfly installation bin directory:

cd ${wildfly-home}/wildfly-8.0.0.Alpha1/bin

Run the setup CLI script, this process:
1) Reorganizes the default domain configuration
2) Creates 3 server instances (server-one, server-two and server-three) with port offsets of 0, 100 and 200 respectively and configures then with the "full" profile and ensures that they are setup to "auto-start"
3) Re-loads the configuration changes
4) Starts all the servers

./jboss-cli.sh --connect --file=setup-wildfly.cli

Application Deployment
----------------------
Now we can deploy the application.  Run the following command from the ${wildfly-home}/wildfly-8.0.0.Alpha1/bin directory:

Note that you will need to substitute ${source} with the path to the root of your download of the project source code...

./jboss-cli.sh --connect --command="deploy --all-server-groups ${source}/target/jdg-websocket.war"







